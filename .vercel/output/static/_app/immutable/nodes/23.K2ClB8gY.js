import"../chunks/Bzak7iHL.js";import{p as Oe,j as d,o as be,d as m,a as i,b as Se,e as Qe,s as a,g as l,$ as We,i as e,n as he,r as n,t as ce,f as T,h as r,c as ve,k as _e,m as Ye}from"../chunks/DCMERdpK.js";import{d as Je,s as xe,e as ye}from"../chunks/8jpNibKI.js";import{i as b}from"../chunks/CXnZBGaQ.js";import{h as Ke}from"../chunks/B1_jHp8y.js";import{r as k,s as Xe}from"../chunks/kEpiv2GH.js";import{s as ue}from"../chunks/DDc__TWD.js";import{b as j,a as Ze}from"../chunks/D99Ln1cZ.js";import{a as et,s as tt}from"../chunks/D-d23D4K.js";import{c as rt}from"../chunks/CfUxREeX.js";import{g as at}from"../chunks/CzxsKxIF.js";import{p as st}from"../chunks/DQ5x3iEO.js";async function ot($,H){const{data:I,error:N}=await $.from("referral_codes").select("id, user_id, is_active, uses_count, max_uses").eq("code",H.toUpperCase()).single();if(N||!I)return{valid:!1};const x=I;return x.is_active?x.max_uses!==null&&x.uses_count>=x.max_uses?{valid:!1}:{valid:!0,codeId:x.id,referrerId:x.user_id}:{valid:!1}}var it=m('<a href="/login" class="underline ml-1">Ir a login</a>'),lt=m('<div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 text-sm"> <!></div>'),nt=m('<div class="space-y-4"><p class="text-sm text-gray-600 text-center mb-4">쮺칩mo quieres usar Plenura?</p> <button type="button"><div class="flex items-start gap-4"><div class="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center text-2xl">游븾</div> <div><h3 class="font-semibold text-gray-900">Busco servicios de bienestar</h3> <p class="text-sm text-gray-500 mt-1">Encuentra terapeutas, reserva citas y cuida tu salud</p></div></div></button> <button type="button"><div class="flex items-start gap-4"><div class="w-12 h-12 bg-secondary-100 rounded-xl flex items-center justify-center text-2xl">游눉</div> <div><h3 class="font-semibold text-gray-900">Soy terapeuta o profesional</h3> <p class="text-sm text-gray-500 mt-1">Ofrece tus servicios y haz crecer tu negocio</p></div></div></button></div> <div class="relative my-6"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-200"></div></div> <div class="relative flex justify-center text-sm"><span class="px-4 bg-white text-gray-500">o reg칤strate con</span></div></div> <button type="button" class="w-full flex items-center justify-center gap-3 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"><svg class="w-5 h-5" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg> <span class="text-gray-700 font-medium">Google</span></button>',1),dt=m('<div class="absolute right-3 top-1/2 -translate-y-1/2"><svg class="animate-spin h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg></div>'),ct=m('<div class="absolute right-3 top-1/2 -translate-y-1/2"><svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div>'),vt=m('<div class="absolute right-3 top-1/2 -translate-y-1/2"><svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></div>'),ut=m('<p class="text-xs text-red-500 mt-1">C칩digo no v치lido o expirado</p>'),pt=m('<p class="text-xs text-green-600 mt-1">춰C칩digo v치lido! Recibir치s beneficios al registrarte</p>'),ft=_e('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"></path></svg>'),mt=_e('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>'),gt=m('<span class="inline-flex items-center gap-2"><svg class="animate-spin h-4 w-4" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Creando cuenta...</span>'),bt=m('<form class="space-y-4"><div class="flex items-center gap-2 mb-4"><button type="button" class="text-gray-400 hover:text-gray-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <span class="text-sm text-gray-500"> </span></div> <div><label for="fullName" class="block text-sm font-medium text-gray-700 mb-1.5">Nombre completo</label> <input type="text" id="fullName" required placeholder="Tu nombre" class="input-wellness"/></div> <div><label for="email" class="block text-sm font-medium text-gray-700 mb-1.5">Correo electr칩nico</label> <input type="email" id="email" required placeholder="tu@email.com" class="input-wellness"/></div> <div><label for="phone" class="block text-sm font-medium text-gray-700 mb-1.5">Tel칠fono (opcional)</label> <input type="tel" id="phone" placeholder="+52 55 1234 5678" class="input-wellness"/></div> <div><label for="referralCode" class="block text-sm font-medium text-gray-700 mb-1.5">C칩digo de referido (opcional)</label> <div class="relative"><input type="text" id="referralCode" placeholder="Ej: ABC12345"/> <!></div> <!></div> <div><label for="password" class="block text-sm font-medium text-gray-700 mb-1.5">Contrase침a</label> <div class="relative"><input id="password" required placeholder="M칤nimo 8 caracteres" class="input-wellness pr-10"/> <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"><!></button></div></div> <div><label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-1.5">Confirmar contrase침a</label> <input type="password" id="confirmPassword" required placeholder="Repite tu contrase침a" class="input-wellness"/></div> <div class="flex items-start gap-3 pt-2"><input type="checkbox" id="terms" class="mt-1 h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"/> <label for="terms" class="text-sm text-gray-600">Acepto los <a href="/terms" class="text-primary-600 hover:underline">t칠rminos y condiciones</a> y la <a href="/privacy" class="text-primary-600 hover:underline">pol칤tica de privacidad</a></label></div> <button type="submit" class="w-full btn-primary-gradient py-3 mt-4 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></form>'),ht=m('<div><h1 class="text-2xl font-bold text-gray-900 text-center mb-2">Crea tu cuenta</h1> <p class="text-gray-500 text-center mb-8">칔nete a la comunidad de bienestar</p> <!> <!> <p class="text-center text-sm text-gray-500 mt-8">쯏a tienes cuenta? <a href="/login" class="text-primary-600 hover:text-primary-700 font-medium">Inicia sesi칩n</a></p></div>');function It($,H){Oe(H,!0);const I=()=>et(st,"$page",N),[N,x]=tt(),pe=I().url.searchParams.get("ref")??"";let P=d(1),C=d("client"),A=d(""),B=d(""),U=d(""),V=d(""),D=d(""),h=d(be(pe)),F=d(null),y=d(be(pe?null:!0)),G=d(!1),g=d(!1),p=d(null),q=d(!1),O=d(!1);const S=rt();async function we(){if(!e(h).trim()){r(y,!0),r(F,null);return}r(O,!0);const s=await ot(S,e(h).trim());r(y,s.valid,!0),r(F,s.codeId??null,!0),r(O,!1)}function ke(){return e(B).length<8?"La contrase침a debe tener al menos 8 caracteres":e(B)!==e(U)?"Las contrase침as no coinciden":null}async function Ce(s){var v;s.preventDefault(),r(p,null);const c=ke();if(c){r(p,c,!0);return}if(!e(G)){r(p,"Debes aceptar los t칠rminos y condiciones");return}r(g,!0);try{const{data:u,error:f}=await S.auth.signUp({email:e(A),password:e(B),options:{data:{full_name:e(V),phone:e(D),role:e(C),referral_code_id:e(F)},emailRedirectTo:`${window.location.origin}/auth/callback`}});if(f){f.message.includes("already registered")?r(p,"Este correo ya est치 registrado. 쯈uieres iniciar sesi칩n?"):r(p,f.message,!0);return}if(u.user){if(((v=u.user.identities)==null?void 0:v.length)===0){r(p,"Este correo ya est치 registrado");return}at("/register/confirm?email="+encodeURIComponent(e(A)))}}catch{r(p,"Error al crear la cuenta. Intenta de nuevo.")}finally{r(g,!1)}}async function Me(){const{error:s}=await S.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});s&&r(p,s.message,!0)}var Q=ht();Ke("ydeots",s=>{Qe(()=>{We.title="Crear Cuenta - Plenura"})});var fe=a(l(Q),4);{var je=s=>{var c=lt(),v=l(c),u=a(v);{var f=w=>{var z=it();i(w,z)};b(u,w=>{e(p).includes("iniciar sesi칩n")&&w(f)})}n(c),ce(()=>xe(v,`${e(p)??""} `)),i(s,c)};b(fe,s=>{e(p)&&s(je)})}var Be=a(fe,2);{var ze=s=>{var c=nt(),v=T(c),u=a(l(v),2);u.__click=()=>{r(C,"client"),r(P,2)};var f=a(u,2);f.__click=()=>{r(C,"therapist"),r(P,2)},n(v);var w=a(v,4);w.__click=Me,ce(()=>{ue(u,1,`w-full p-4 border-2 rounded-xl text-left transition-all hover:border-primary-500 hover:bg-primary-50 ${e(C)==="client"?"border-primary-500 bg-primary-50":"border-gray-200"}`),ue(f,1,`w-full p-4 border-2 rounded-xl text-left transition-all hover:border-secondary-500 hover:bg-secondary-50 ${e(C)==="therapist"?"border-secondary-500 bg-secondary-50":"border-gray-200"}`)}),i(s,c)},Re=s=>{var c=bt(),v=l(c),u=l(v);u.__click=()=>r(P,1);var f=a(u,2),w=l(f);n(f),n(v);var z=a(v,2),W=a(l(z),2);k(W),n(z);var Y=a(z,2),J=a(l(Y),2);k(J),n(Y);var K=a(Y,2),X=a(l(K),2);k(X),n(K);var Z=a(K,2),ee=a(l(Z),2),M=l(ee);k(M);var Ee=a(M,2);{var Ie=t=>{var o=dt();i(t,o)},Pe=t=>{var o=ve(),le=T(o);{var ne=_=>{var L=ct();i(_,L)},E=_=>{var L=ve(),De=T(L);{var Fe=de=>{var Ge=vt();i(de,Ge)};b(De,de=>{e(h)&&e(y)===!1&&de(Fe)},!0)}i(_,L)};b(le,_=>{e(h)&&e(y)?_(ne):_(E,!1)},!0)}i(t,o)};b(Ee,t=>{e(O)?t(Ie):t(Pe,!1)})}n(ee);var Ae=a(ee,2);{var qe=t=>{var o=ut();i(t,o)},Le=t=>{var o=ve(),le=T(o);{var ne=E=>{var _=pt();i(E,_)};b(le,E=>{e(h)&&e(y)&&E(ne)},!0)}i(t,o)};b(Ae,t=>{e(h)&&e(y)===!1?t(qe):t(Le,!1)})}n(Z);var te=a(Z,2),me=a(l(te),2),R=l(me);k(R);var re=a(R,2);re.__click=()=>r(q,!e(q));var Te=l(re);{var $e=t=>{var o=ft();i(t,o)},He=t=>{var o=mt();i(t,o)};b(Te,t=>{e(q)?t($e):t(He,!1)})}n(re),n(me),n(te);var ae=a(te,2),se=a(l(ae),2);k(se),n(ae);var oe=a(ae,2),ge=l(oe);k(ge),he(2),n(oe);var ie=a(oe,2),Ne=l(ie);{var Ue=t=>{var o=gt();i(t,o)},Ve=t=>{var o=Ye("Crear cuenta");i(t,o)};b(Ne,t=>{e(g)?t(Ue):t(Ve,!1)})}n(ie),n(c),ce(()=>{xe(w,`Registr치ndote como ${e(C)==="client"?"cliente":"terapeuta"}`),W.disabled=e(g),J.disabled=e(g),X.disabled=e(g),ue(M,1,`input-wellness uppercase ${e(y)===!1?"border-red-300 focus:border-red-500 focus:ring-red-500":e(y)&&e(h)?"border-green-300 focus:border-green-500 focus:ring-green-500":""}`),M.disabled=e(g),Xe(R,"type",e(q)?"text":"password"),R.disabled=e(g),se.disabled=e(g),ie.disabled=e(g)}),ye("submit",c,Ce),j(W,()=>e(V),t=>r(V,t)),j(J,()=>e(A),t=>r(A,t)),j(X,()=>e(D),t=>r(D,t)),ye("blur",M,we),j(M,()=>e(h),t=>r(h,t)),j(R,()=>e(B),t=>r(B,t)),j(se,()=>e(U),t=>r(U,t)),Ze(ge,()=>e(G),t=>r(G,t)),i(s,c)};b(Be,s=>{e(P)===1?s(ze):s(Re,!1)})}he(2),n(Q),i($,Q),Se(),x()}Je(["click"]);export{It as component};
